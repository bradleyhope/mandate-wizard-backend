<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Profile - Netflix Mandate Wizard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header h2 {
            font-size: 20px;
            font-weight: 400;
            opacity: 0.9;
        }
        
        .back-link {
            display: inline-block;
            color: white;
            text-decoration: none;
            margin-bottom: 15px;
            opacity: 0.9;
            transition: opacity 0.2s;
        }
        
        .back-link:hover {
            opacity: 1;
        }
        
        .profile-content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section h3 {
            font-size: 20px;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .section p, .section ul, .section ol {
            line-height: 1.6;
            color: #333;
        }
        
        .section ul, .section ol {
            margin-left: 20px;
        }
        
        .section li {
            margin-bottom: 8px;
        }
        
        .quote {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin: 15px 0;
            font-style: italic;
        }
        
        .quote-source {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
            font-style: normal;
        }
        
        .project {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
        }
        
        .project-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .project-meta {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .project-desc {
            color: #333;
            line-height: 1.5;
        }
        
        .badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            margin: 2px;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #666;
        }
        
        .error {
            background: #fee;
            border: 1px solid #fcc;
            color: #c33;
            padding: 20px;
            border-radius: 6px;
            margin: 20px;
        }
        
        .reporting-structure {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .boss {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .direct-reports {
            margin-top: 15px;
        }
        
        .direct-reports-list {
            list-style: none;
            margin-left: 0;
        }
        
        .direct-reports-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .direct-reports-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-link">‚Üê Back to Mandate Wizard</a>
            <h1 id="exec-name">Loading...</h1>
            <h2 id="exec-title"></h2>
        </div>
        
        <div id="profile-content" class="profile-content">
            <div class="loading">Loading executive profile...</div>
        </div>
    </div>
    
    <script>
        // Get executive name from URL
        const pathParts = window.location.pathname.split('/');
        const execName = decodeURIComponent(pathParts[pathParts.length - 1]);
        
        // Fetch profile
        fetch(`/executive/${encodeURIComponent(execName)}`)
            .then(response => response.json())
            .then(data => {
                if (!data.success) {
                    showError(data.error || 'Failed to load profile');
                    return;
                }
                
                displayProfile(data.profile);
            })
            .catch(error => {
                showError('Error loading profile: ' + error.message);
            });
        
        function displayProfile(profile) {
            // Update header
            document.getElementById('exec-name').textContent = profile.name || 'Unknown';
            document.getElementById('exec-title').textContent = profile.title || '';
            
            // Build content
            let html = '';
            
            // Mandate Summary
            if (profile.mandate_summary) {
                html += `
                    <div class="section">
                        <h3>üìã Mandate</h3>
                        <p>${profile.mandate_summary}</p>
                    </div>
                `;
            }
            
            // Reporting Structure
            if (profile.boss || (profile.direct_reports && profile.direct_reports.length > 0)) {
                html += `<div class="section"><h3>üë• Reporting Structure</h3><div class="reporting-structure">`;
                
                if (profile.boss) {
                    const bossName = profile.boss.full_name || profile.boss.name || 'Unknown';
                    const bossTitle = profile.boss.title || '';
                    html += `<div class="boss">Reports to: ${bossName}${bossTitle ? ` (${bossTitle})` : ''}</div>`;
                }
                
                if (profile.direct_reports && profile.direct_reports.length > 0) {
                    html += `<div class="direct-reports"><strong>Direct Reports (${profile.direct_reports.length}):</strong><ul class="direct-reports-list">`;
                    profile.direct_reports.slice(0, 10).forEach(dr => {
                        const drName = dr.full_name || dr.name || 'Unknown';
                        const drTitle = dr.title || '';
                        html += `<li>${drName}${drTitle ? ` ‚Äî ${drTitle}` : ''}</li>`;
                    });
                    html += `</ul></div>`;
                }
                
                html += `</div></div>`;
            }
            
            // Regional Coverage
            if (profile.regions && profile.regions.length > 0) {
                const regionNames = profile.regions.map(r => r.name).filter(n => n);
                if (regionNames.length > 0) {
                    html += `
                        <div class="section">
                            <h3>üåç Regional Coverage</h3>
                            <p>${regionNames.map(r => `<span class="badge">${r}</span>`).join(' ')}</p>
                        </div>
                    `;
                }
            }
            
            // What Works / What Doesn't
            if (profile.what_works && profile.what_works.length > 0) {
                html += `
                    <div class="section">
                        <h3>‚úÖ What Works</h3>
                        <ul>
                            ${profile.what_works.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            if (profile.what_doesnt_work && profile.what_doesnt_work.length > 0) {
                html += `
                    <div class="section">
                        <h3>‚ùå What Doesn't Work</h3>
                        <ul>
                            ${profile.what_doesnt_work.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            // Recent Quotes
            if (profile.quotes && profile.quotes.length > 0) {
                html += `<div class="section"><h3>üí¨ Recent Quotes</h3>`;
                profile.quotes.slice(0, 5).forEach(quote => {
                    const quoteText = quote.quote || quote.text || '';
                    const source = quote.source || '';
                    const date = quote.date || '';
                    const url = quote.url || '';
                    
                    let citation = '';
                    if (source || date) {
                        const parts = [source, date].filter(p => p);
                        citation = parts.join(', ');
                    }
                    
                    html += `
                        <div class="quote">
                            "${quoteText}"
                            ${citation ? `<div class="quote-source">‚Äî ${url ? `<a href="${url}" target="_blank">${citation}</a>` : citation}</div>` : ''}
                        </div>
                    `;
                });
                html += `</div>`;
            }
            
            // Recent Projects
            if (profile.projects && profile.projects.length > 0) {
                html += `<div class="section"><h3>üé¨ Recent Projects</h3>`;
                
                // Group by year
                const byYear = {};
                profile.projects.forEach(project => {
                    const year = project.greenlight_year || 'Unknown';
                    if (!byYear[year]) byYear[year] = [];
                    byYear[year].push(project);
                });
                
                // Sort years descending
                const years = Object.keys(byYear).sort((a, b) => b - a);
                
                years.forEach(year => {
                    if (year !== 'Unknown') {
                        html += `<h4 style="margin-top: 20px; color: #667eea;">${year}</h4>`;
                    }
                    
                    byYear[year].slice(0, 10).forEach(project => {
                        const title = project.title || 'Untitled';
                        const type = project.type || '';
                        const description = project.description || '';
                        
                        html += `
                            <div class="project">
                                <div class="project-title">${title}${type ? ` (${type})` : ''}</div>
                                ${description && description.length < 200 ? `<div class="project-desc">${description}</div>` : ''}
                            </div>
                        `;
                    });
                });
                
                html += `</div>`;
            }
            
            // Pitch Approach
            if (profile.pitch_approach) {
                html += `
                    <div class="section">
                        <h3>üéØ Pitch Approach</h3>
                        <p>${profile.pitch_approach}</p>
                    </div>
                `;
            }
            
            document.getElementById('profile-content').innerHTML = html;
        }
        
        function showError(message) {
            document.getElementById('profile-content').innerHTML = `
                <div class="error">
                    <strong>Error:</strong> ${message}
                </div>
            `;
        }
    </script>
</body>
</html>

